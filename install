#!/bin/bash

dir="$( cd "$( dirname "${BASH_SOURCE:-$0}" )" && pwd )"

ctags_path="${HOME}/.ctags"
if [ -L $ctags_path ]; then
  rm $ctags_path # If its a link, remove it
elif [ -f $ctags_path ]; then
  tmp=$(mktemp -d)
  echo "${ctags_path} exists already! moving to ${tmp}"
  mv $ctags_path "${tmp}/"
fi
ln -s "${dir}/ctags" $ctags_path

for file in gitconfig gitignore hushlogin tmux.conf vimrc zshrc ideavimrc
do
  install_path="${HOME}/.${file}"

  if [ -L $install_path ]; then
    rm $install_path # If its a link, remove it
  elif [ -f $install_path ]; then
    tmp=$(mktemp -d)
    echo "${install_path} exists already! moving to ${tmp}"
    mv $install_path "${tmp}/"
  fi

  ln -s "${dir}/${file}" $install_path
done

if [[ $(type -P vim) ]]; then

  if [ ! -e "${HOME}/.vim/autoload/plug.vim" ]; then
    curl -fLo ~/.vim/autoload/plug.vim --create-dirs \
          https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
  fi

  vim +PlugUpdate +qall
fi
